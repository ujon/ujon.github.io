"use strict";(self.webpackChunkujon_github_io=self.webpackChunkujon_github_io||[]).push([[925],{2022:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/20251226_order_sq-b327ab5bb507e54959ad395deb67227c.svg"},4854:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/20251226_qr_order-4e7e1879c520f646639e124373eb1f8a.png"},7101:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});var i=s(9189),r=s(4848),t=s(8453);const l={slug:"20251226__qr_order",title:"[System Design] QR Order",author:"ujon",date:new Date("2025-12-26T00:00:00.000Z"),tags:["system-design"]},a=void 0,d={authorsImageUrls:[void 0]},o=[{value:"Overview",id:"overview",level:2},{value:"Requirements",id:"requirements",level:2},{value:"System Design",id:"system-design",level:2},{value:"Websocket Server",id:"websocket-server",level:3},{value:"Client API",id:"client-api",level:3},{value:"Admin API",id:"admin-api",level:3},{value:"Sequence Diagram",id:"sequence-diagram",level:2}];function c(e){const n={h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"During a trip to the US, I had a great experience using a QR code ordering and payment system at a restaurant. Recently, I encountered the same system at a restaurant in Korea during lunch and decided to design it myself."}),"\n",(0,r.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Customers can place orders by scanning a QR code"}),"\n",(0,r.jsx)(n.li,{children:"Each table has a unique QR code"}),"\n",(0,r.jsx)(n.li,{children:"Multiple customers at the same table can share a cart in real-time and order together"}),"\n",(0,r.jsx)(n.li,{children:"The kitchen can immediately view completed orders"}),"\n",(0,r.jsx)(n.li,{children:"Orders cannot be placed from outside the restaurant"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"system-design",children:"System Design"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"system design",src:s(4854).A+"",width:"1701",height:"1071"})}),"\n",(0,r.jsx)(n.h3,{id:"websocket-server",children:"Websocket Server"}),"\n",(0,r.jsx)(n.p,{children:"Handles real-time communication and runs as a separate instance from the Client API and Admin API for load distribution."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Features"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Real-time cart synchronization between customers at the same table"}),"\n",(0,r.jsx)(n.li,{children:"Order notifications to kitchen devices"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Cart Synchronization","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Uses Redis Pub/Sub to manage channels and support horizontal scaling."}),"\n",(0,r.jsx)(n.li,{children:"Pub/Sub does not persist messages, which means there is a possibility of message loss. However, since cart data is ephemeral and can be re-synced during order confirmation, Streams is not used."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Order Processing","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Uses Redis Streams to ensure orders are reliably delivered to the kitchen."}),"\n",(0,r.jsx)(n.li,{children:"Implements Consumer Groups to enable reprocessing in case of failures."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"client-api",children:"Client API"}),"\n",(0,r.jsx)(n.p,{children:"Provides APIs for customers."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Features"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Menu listing"}),"\n",(0,r.jsx)(n.li,{children:"Order submission"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Order Submission","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Validates menu item consistency upon order submission. Applies Optimistic Locking to handle concurrency issues when menu items have limited availability."}),"\n",(0,r.jsx)(n.li,{children:"Produces order messages to Redis Streams so the kitchen can receive them."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Security Considerations"})}),"\n",(0,r.jsx)(n.p,{children:"The following validation logic is required to block orders from outside the restaurant:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Client IP validation (verify the request originates from the restaurant's network)"}),"\n",(0,r.jsx)(n.li,{children:"GPS coordinate validation (calculate distance from the restaurant's location)"}),"\n",(0,r.jsx)(n.li,{children:"Combination of both conditions to prevent bypass attempts"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"admin-api",children:"Admin API"}),"\n",(0,r.jsx)(n.p,{children:"Provides APIs for restaurant owners and staff."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Features"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Menu registration and management"}),"\n",(0,r.jsx)(n.li,{children:"Table-specific billing summary"}),"\n",(0,r.jsx)(n.li,{children:"Order status management"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"sequence-diagram",children:"Sequence Diagram"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"sequencediagram",src:s(2022).A+"",width:"1335",height:"2218"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},9189:e=>{e.exports=JSON.parse('{"permalink":"/blog/20251226__qr_order","source":"@site/blog/20251226/index.md","title":"[System Design] QR Order","description":"Overview","date":"2025-12-26T00:00:00.000Z","tags":[{"inline":false,"label":"System Design","permalink":"/blog/tags/system-design"}],"readingTime":1.63,"hasTruncateMarker":false,"authors":[{"name":"ujon","key":null,"page":null}],"frontMatter":{"slug":"20251226__qr_order","title":"[System Design] QR Order","author":"ujon","date":"2025-12-26T00:00:00.000Z","tags":["system-design"]},"unlisted":false,"nextItem":{"title":"[Project Structure] Spring Boot","permalink":"/blog/20251201__project_structure__spring_boot"}}')}}]);